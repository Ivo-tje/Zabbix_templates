zabbix_export:
  version: '7.2'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 3a4d40b14e4147928c25ad10a159f59c
      template: 'MikroTik by SNMP Bulk'
      name: 'MikroTik by SNMP Bulk'
      vendor:
        name: 'Ivo Schooneman'
        version: 6.4-0
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 5964ebe618d647ce82be32ec78d76c12
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          history: 1w
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
        - uuid: 246a1e64bab542519a8d5a46dadebc2a
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
        - uuid: bbd9b3eb5bb14b1da519340f975278df
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
        - uuid: f18b04322d2147018492f6de69ad1924
          name: 'SNMP Walk cpu'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.25.3.3.1.1,1.3.6.1.2.1.25.3.3.1.2]'
          key: snmp.walk.cpu
          delay: 15s
          history: '0'
          value_type: TEXT
        - uuid: f13c4abb62804705adde9e66879aea0b
          name: 'SNMP Walk cpu temperature'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.14988.1.1.3.11]'
          key: snmp.walk.cputemp
          delay: 15s
          history: '0'
          value_type: TEXT
        - uuid: ffaee34346564031914797a6e3d241aa
          name: 'SNMP Walk Interfaces'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.5,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.2.2.1.10,1.3.6.1.2.1.2.2.1.16,.1.3.6.1.2.1.2.2.1.13,.1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.2.2.1.8,.1.3.6.1.2.1.2.2.1.20,.1.3.6.1.2.1.2.2.1.19]'
          key: snmp.walk.if
          delay: 15s
          history: '0'
          value_type: TEXT
        - uuid: 0a96860b54964f8ebd0e45a87d2123f7
          name: 'SNMP Walk storage'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.25.2.3.1.3,1.3.6.1.2.1.25.2.3.1.4,1.3.6.1.2.1.25.2.3.1.2]'
          key: snmp.walk.storage
          delay: 15s
          history: '0'
          value_type: TEXT
        - uuid: b9975b9b63044fd48b169bf33e43c6d1
          name: 'SNMP Walk temperature sensors'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.14988.1.1.3.10]'
          key: snmp.walk.temp
          delay: 15s
          history: 1h
          value_type: TEXT
        - uuid: e55319502c0a44ebbc08775f404824bd
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 722d5b0f71df426fa7352b6a38ff0a7f
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 9ae7b43479694b239955fefe022921d9
          name: 'Firmware version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14988.1.1.7.4.0
          key: system.hw.firmware
          delay: 1h
          history: 2w
          value_type: CHAR
          description: |
            MIB: MIKROTIK-MIB
            Current firmware version.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: c3faeb722c5b4a9fa4a202e34b05d8a5
          name: 'Hardware model name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: system.hw.model
          delay: 1h
          history: 2w
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 785caf93358c4831835c896300fa1dce
          name: 'Hardware serial number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14988.1.1.7.3.0
          key: system.hw.serialnumber
          delay: 1h
          history: 2w
          value_type: CHAR
          description: |
            MIB: MIKROTIK-MIB
            RouterBOARD serial number.
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 691212a3c0a645dcb7cfb3a6901bdfb9
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.1.1.0
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 0b3067c909484938a8177ffb77323d6f
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 140e1d873b524e74bf0fb33595921b3a
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 15m
          history: 2w
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 7d06b051d08b426198b0cb565202856a
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 8c4ae9e9df7f40c999d055bbe1a30ac8
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 48da7d42c18149ee98f6419b8c22c280
          name: 'Operating system'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14988.1.1.4.4.0
          key: 'system.sw.os[mtxrLicVersion.0]'
          delay: 1h
          history: 2w
          value_type: CHAR
          description: |
            MIB: MIKROTIK-MIB
            Software version.
          inventory_link: OS
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
        - uuid: ac900fc736cc4e69a099ce235621f1a1
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.2.3.1.5.65536
          key: 'vm.memory.total[hrStorageSize.Memory]'
          history: 7d
          units: B
          description: |
            MIB: HOST-RESOURCES-MIB
            The size of the storage represented by this entry, in
            units of hrStorageAllocationUnits. This object is
            writable to allow remote configuration of the size of
            the storage area in those cases where such an
            operation makes sense and is possible on the
            underlying system. For example, the amount of main
            memory allocated to a buffer pool might be modified or
            the amount of disk space allocated to virtual memory
            might be modified.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 2043789c0a564c27aebd62687722c190
          name: 'Used memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.2.3.1.6.65536
          key: 'vm.memory.used[hrStorageUsed.Memory]'
          history: 7d
          units: B
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 893804bea9d6441883c41e0de98f6082
          name: 'Memory utilization'
          type: CALCULATED
          key: 'vm.memory.util[memoryUsedPercentage.Memory]'
          history: 7d
          value_type: FLOAT
          units: '%'
          params: 'last(//vm.memory.used[hrStorageUsed.Memory])/last(//vm.memory.total[hrStorageSize.Memory])*100'
          description: 'Memory utilization in %.'
          tags:
            - tag: component
              value: memory
        - uuid: 7efa448b132b40a98c7c73871cf987ed
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible value:
            0 - not available
            1 - available
            2 - unknown
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
      discovery_rules:
        - uuid: 37f2f0ae2cb54519aadf83bcd39fedc4
          name: 'CPU discovery'
          type: DEPENDENT
          key: hrProcessorLoad.discovery
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'HOST-RESOURCES-MIB::hrProcessorTable discovery'
          item_prototypes:
            - uuid: 27cc2426d1194c9881d80f0dd321a02a
              name: '#{#SNMPINDEX}: CPU utilization'
              type: DEPENDENT
              key: 'system.cpu.util[hrProcessorLoad.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: HOST-RESOURCES-MIB
                The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: snmp.walk.cpu
              tags:
                - tag: component
                  value: cpu
              trigger_prototypes:
                - uuid: b5b015261fd94709a470332a0b1e85ac
                  expression: 'min(/MikroTik by SNMP Bulk/system.cpu.util[hrProcessorLoad.{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: '#{#SNMPINDEX}: High CPU utilization'
                  event_name: '#{#SNMPINDEX}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
                  tags:
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: ce46e58bf02b4efdb65af48bac6bd71e
              name: '#{#SNMPINDEX}: CPU utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'MikroTik by SNMP Bulk'
                    key: 'system.cpu.util[hrProcessorLoad.{#SNMPINDEX}]'
          master_item:
            key: snmp.walk.cpu
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#CPU.UTIL}'
                - .1.3.6.1.2.1.25.3.3.1.1
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: ad743afb0b464fd4a41461758e1018ac
          name: 'Temperature CPU discovery'
          type: DEPENDENT
          key: mtxrHlProcessorTemperature.discovery
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: |
            MIKROTIK-MIB::mtxrHlProcessorTemperature
            Since temperature of CPU is not available on all Mikrotik hardware, this is done to avoid unsupported items.
          item_prototypes:
            - uuid: 526737b11f9142c4b7a6bde22fb08307
              name: 'CPU: Temperature'
              type: DEPENDENT
              key: 'sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}]'
              history: 90d
              value_type: FLOAT
              units: °C
              description: |
                MIB: MIKROTIK-MIB
                mtxrHlProcessorTemperature Processor temperature in Celsius (degrees C).
                Might be missing in entry models (RB750, RB450G..).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.14988.1.1.3.11
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              master_item:
                key: snmp.walk.cputemp
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: 2e3bd83f9ce74d2fa8d16bfe877cbcee
                  expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"CPU"}-3'
                  name: 'CPU: Temperature is above critical threshold'
                  event_name: 'CPU: Temperature is above critical threshold: >{$TEMP_CRIT:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: 50a59c174c4d4cd9a0d7f4050b8af573
                  expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)>{$TEMP_WARN:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)<{$TEMP_WARN:"CPU"}-3'
                  name: 'CPU: Temperature is above warning threshold'
                  event_name: 'CPU: Temperature is above warning threshold: >{$TEMP_WARN:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    - name: 'CPU: Temperature is above critical threshold'
                      expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"CPU"}'
                      recovery_expression: 'max(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"CPU"}-3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scopre
                      value: performance
                - uuid: 8e44e316db7347be8ba79bc3488d8e4e
                  expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)<{$TEMP_CRIT_LOW:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'min(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}],5m)>{$TEMP_CRIT_LOW:"CPU"}+3'
                  name: 'CPU: Temperature is too low'
                  event_name: 'CPU: Temperature is too low: <{$TEMP_CRIT_LOW:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          master_item:
            key: snmp.walk.cputemp
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#CPU.TEMP}'
                - 1.3.6.1.4.1.14988.1.1.3.11
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 1355d6d76ff943688a970bac2b95d4b8
          name: 'Temperature sensor discovery'
          type: DEPENDENT
          key: mtxrHlTemperature.discovery
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: |
            MIKROTIK-MIB::mtxrHlTemperature
            Since temperature sensor is not available on all Mikrotik hardware, this is done to avoid unsupported items.
          item_prototypes:
            - uuid: 0a4d9f9e161f4331a18e255f9fbc9b76
              name: 'Device: Temperature'
              type: DEPENDENT
              key: 'sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}]'
              history: 90d
              value_type: FLOAT
              units: °C
              description: |
                MIB: MIKROTIK-MIB
                mtxrHlTemperature Device temperature in Celsius (degrees C).
                Might be missing in entry models (RB750, RB450G..).
                
                Reference: http://wiki.mikrotik.com/wiki/Manual:SNMP
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.14988.1.1.3.10.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              master_item:
                key: snmp.walk.temp
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: d574a7f0635d4f01bb110581fcd7eb0f
                  expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"Device"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"Device"}-3'
                  name: 'Device: Temperature is above critical threshold'
                  event_name: 'Device: Temperature is above critical threshold: >{$TEMP_CRIT:"Device"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: 4e5dd675d5a74b9bacca9078798f83f8
                  expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)>{$TEMP_WARN:"Device"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)<{$TEMP_WARN:"Device"}-3'
                  name: 'Device: Temperature is above warning threshold'
                  event_name: 'Device: Temperature is above warning threshold: >{$TEMP_WARN:"Device"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    - name: 'Device: Temperature is above critical threshold'
                      expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"Device"}'
                      recovery_expression: 'max(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"Device"}-3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: 0e1a3bcc83d546538f89824e255b8205
                  expression: 'avg(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)<{$TEMP_CRIT_LOW:"Device"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'min(/MikroTik by SNMP Bulk/sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}],5m)>{$TEMP_CRIT_LOW:"Device"}+3'
                  name: 'Device: Temperature is too low'
                  event_name: 'Device: Temperature is too low: <{$TEMP_CRIT_LOW:"Device"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          master_item:
            key: snmp.walk.temp
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#TEMP.SENS}'
                - 1.3.6.1.4.1.14988.1.1.3.10
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 4352f41850d3483cad5b0deefa510b0d
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: 6df1e4259d86443c9048f99de0350cd5
              name: 'Interface {#IF.DESCR}: Inbound packets discarded'
              type: DEPENDENT
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: a5714e29fdb94d17a522c75d03b60d4c
              name: 'Interface {#IF.DESCR}: Inbound packets with errors'
              type: DEPENDENT
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: 7be8de44f8db4019944ac1dfb06b2cba
              name: 'Interface {#IF.DESCR}: Bits received'
              type: DEPENDENT
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              history: 90d
              units: Bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: c5b27d6a852243c0a02af651b5aacdab
              name: 'Interface {#IF.DESCR}: Outbound packets discarded'
              type: DEPENDENT
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: 3efee9a5505a48dc9c711002a3dd4d03
              name: 'Interface {#IF.DESCR}: Outbound packets with errors'
              type: DEPENDENT
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: 4bc7713769f64d7faf02162dd4f2c3ae
              name: 'Interface {#IF.DESCR}: Bits sent'
              type: DEPENDENT
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              history: 90d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: 4a9a7253c4ad449e816b4a055ba29f05
              name: 'Interface {#IF.DESCR}: Speed'
              type: DEPENDENT
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              history: 90d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: 0df6e8c632014b4cb81f30179d55dcaf
              name: 'Interface {#IF.DESCR}: Admin status'
              type: DEPENDENT
              key: 'net.if.status[ifAdminStatus.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.7.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
            - uuid: 28c293b491e6417b8f1c63026192c3c6
              name: 'Interface {#IF.DESCR}: Operational status'
              type: DEPENDENT
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
              trigger_prototypes:
                - uuid: 51f0198757fa404ca3bfe4c5a464f729
                  expression: '{$IFCONTROL:"{#IFDESCR}"}=1 and last(/MikroTik by SNMP Bulk/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/MikroTik by SNMP Bulk/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/MikroTik by SNMP Bulk/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/MikroTik by SNMP Bulk/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFDESCR}"}=0'
                  name: 'Interface {#IF.DESCR}: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$IFCONTROL:"{#IFDESCR}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  manual_close: 'YES'
            - uuid: 625974c75af74142a8a238cf8d5d356f
              name: 'Interface {#IF.DESCR}: Interface type'
              type: DEPENDENT
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              history: 90d
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: snmp.walk.if
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IF.DESCR}'
                - tag: interface
                  value: '{#IF.DESCR}'
          trigger_prototypes:
            - uuid: 5c7977f16973415eb104c3c9b3e5c4b8
              expression: |
                change(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/MikroTik by SNMP Bulk/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/MikroTik by SNMP Bulk/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/MikroTik by SNMP Bulk/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/MikroTik by SNMP Bulk/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/MikroTik by SNMP Bulk/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/MikroTik by SNMP Bulk/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/MikroTik by SNMP Bulk/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
                and
                {$IFCONTROL:"{#IFDESCR}"}=1
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/MikroTik by SNMP Bulk/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
                or
                {$IFCONTROL:"{#IFDESCR}"}=0
              name: 'Interface {#IF.DESCR}: Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.'
              manual_close: 'YES'
            - uuid: 5ba97e4527844157b70417f06dab1ed1
              expression: |
                (avg(/MikroTik by SNMP Bulk/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFDESCR}"}/100)*last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/MikroTik by SNMP Bulk/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFDESCR}"}/100)*last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/MikroTik by SNMP Bulk/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFDESCR}"}-3)/100)*last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/MikroTik by SNMP Bulk/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFDESCR}"}-3)/100)*last(/MikroTik by SNMP Bulk/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IF.DESCR}: High bandwidth usage'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
          graph_prototypes:
            - uuid: b5d8adc38e5a484cac5497f93d1923e0
              name: 'Interface {#IF.DESCR}: Network traffic'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik by SNMP Bulk'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik by SNMP Bulk'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
          master_item:
            key: snmp.walk.if
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#IF.DESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#IF.SPEED}'
                - 1.3.6.1.2.1.2.2.1.5
                - '0'
                - '{#IF.ASTATUS}'
                - 1.3.6.1.2.1.2.2.1.7
                - '0'
                - '{#IF.IN.OCTETS}'
                - 1.3.6.1.2.1.2.2.1.10
                - '0'
                - '{#IF.OUT.OCTETS}'
                - 1.3.6.1.2.1.2.2.1.16
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 25ca70a393f443978ba358d76464f273
          name: 'Storage discovery'
          type: DEPENDENT
          key: storage.discovery
          filter:
            evaltype: OR
            conditions:
              - macro: '{#STORAGE_TYPE}'
                value: .+4$
              - macro: '{#STORAGE_TYPE}'
                value: .+hrStorageFixedDisk
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'HOST-RESOURCES-MIB::hrStorage discovery with storage filter'
          item_prototypes:
            - uuid: f72507c95bdf449c8b72a908dc08d9ee
              name: 'Disk-{#SNMPINDEX}: Space utilization'
              type: CALCULATED
              key: 'vfs.fs.pused[hrStorageSize.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: '(last(//vfs.fs.used[hrStorageSize.{#SNMPINDEX}])/last(//vfs.fs.total[hrStorageSize.{#SNMPINDEX}]))*100'
              description: 'Space utilization in % for Disk-{#SNMPINDEX}'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 379ef40bd6144d76a33525c35d966de2
              name: 'Disk-{#SNMPINDEX}: Total space'
              type: DEPENDENT
              key: 'vfs.fs.total[hrStorageSize.{#SNMPINDEX}]'
              history: 90d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The size of the storage represented by this entry, in
                units of hrStorageAllocationUnits. This object is
                writable to allow remote configuration of the size of
                the storage area in those cases where such an
                operation makes sense and is possible on the
                underlying system. For example, the amount of main
                memory allocated to a buffer pool might be modified or
                the amount of disk space allocated to virtual memory
                might be modified.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: snmp.walk.storage
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 191312d4fb5a406fa64163df815697a9
              name: 'Disk-{#SNMPINDEX}: Used space'
              type: DEPENDENT
              key: 'vfs.fs.used[hrStorageSize.{#SNMPINDEX}]'
              history: 90d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: snmp.walk.storage
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
          master_item:
            key: snmp.walk.storage
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#FSNAME}'
                - 1.3.6.1.2.1.25.2.3.1.3
                - '0'
                - '{#ALLOC_UNITS}'
                - 1.3.6.1.2.1.25.2.3.1.4
                - '0'
                - '{#STORAGE_TYPE}'
                - 1.3.6.1.2.1.25.2.3.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: network
        - tag: target
          value: mikrotik
      macros:
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
        - macro: '{$IFCONTROL}'
          value: '1'
          description: 'Use {$IFCONTROL:Port1..5}=0 to stop triggers from link down or speed change.'
      dashboards:
        - uuid: 4de6de698f8c41eaa39bdbd77b9027b9
          name: 'Network Interfaces'
          pages:
            - widgets:
                - type: graphprototype
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'MikroTik by SNMP Bulk'
                        name: 'Interface {#IF.DESCR}: Network traffic'
                    - type: STRING
                      name: reference
                      value: AAAQL
